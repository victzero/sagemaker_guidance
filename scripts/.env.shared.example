# =============================================================================
# SageMaker Platform - Shared Environment Variables
# =============================================================================
# 所有脚本 (01-iam, 02-vpc, 03-s3) 共享的配置
#
# 使用方法:
#   1. 复制此文件: cp .env.shared.example .env.shared
#   2. 编辑 .env.shared 填入实际值
#   3. 各子目录的脚本会自动加载此文件
# =============================================================================

# -----------------------------------------------------------------------------
# AWS 基础配置
# -----------------------------------------------------------------------------

# 公司/组织前缀（用于资源命名，建议 3-8 字符小写）
COMPANY=acme

# AWS 账号 ID（12 位数字）
AWS_ACCOUNT_ID=123456789012

# AWS 区域
AWS_REGION=ap-northeast-1

# AWS Profile（可选，留空使用默认或 CloudShell 内置凭证）
# AWS_PROFILE=

# -----------------------------------------------------------------------------
# 管理员用户 (空格分隔)
# -----------------------------------------------------------------------------
# 将创建用户: sm-admin-{name}
# 示例: "jason alice" -> sm-admin-jason, sm-admin-alice
ADMIN_USERS="jason"

# -----------------------------------------------------------------------------
# 团队配置
# -----------------------------------------------------------------------------
# 团队标识列表 (空格分隔，建议 2-4 个字母缩写)
TEAMS="rc algo"

# 团队全称 (用于 IAM Group 名称，使用 kebab-case)
# 格式: TEAM_{TEAM_ID}_FULLNAME
TEAM_RC_FULLNAME=risk-control
TEAM_ALGO_FULLNAME=algorithm

# -----------------------------------------------------------------------------
# 项目配置
# -----------------------------------------------------------------------------
# 每个团队的项目列表 (空格分隔)
# 格式: {TEAM_ID}_PROJECTS

RC_PROJECTS="fraud-detection anti-money-laundering"
ALGO_PROJECTS="recommendation-engine"

# -----------------------------------------------------------------------------
# 项目用户配置
# -----------------------------------------------------------------------------
# 每个项目的用户列表 (空格分隔，只填用户名部分)
# 格式: {TEAM_ID}_{PROJECT_NAME}_USERS (project-name -> PROJECT_NAME, 用下划线)
#
# 用户命名规则:
#   团队用户: sm-{team}-{username}
#   示例: sm-rc-alice, sm-algo-bob
#
# 注意: 项目名中的连字符 (-) 转换为下划线 (_)
#   fraud-detection -> FRAUD_DETECTION
#   anti-money-laundering -> ANTI_MONEY_LAUNDERING

RC_FRAUD_DETECTION_USERS="alice bob"
RC_ANTI_MONEY_LAUNDERING_USERS="carol"
ALGO_RECOMMENDATION_ENGINE_USERS="david eve"

# -----------------------------------------------------------------------------
# 通用设置
# -----------------------------------------------------------------------------

# 输出目录（相对于各脚本目录）
OUTPUT_DIR=output

# =============================================================================
# 配置说明
# =============================================================================
#
# 以上配置被以下脚本共享:
#
# 【01-iam】创建:
#   - Policies: 基础、团队、项目、执行策略
#   - Groups: 管理员、只读、团队、项目
#   - Users: 管理员用户、团队用户
#   - Roles: 项目执行角色
#
# 【02-vpc】创建:
#   - Security Groups: Studio、VPC Endpoints
#   - VPC Endpoints: SageMaker、STS、S3、Logs 等
#
# 【03-s3】创建:
#   - S3 Buckets: 每个项目一个 bucket
#   - Bucket Policies: 基于团队/项目的访问控制
#   - Lifecycle Rules: 自动归档和清理
#
# =============================================================================

# -----------------------------------------------------------------------------
# VPC 配置（从 02-vpc 配置后复制，供 04-06 模块使用）
# -----------------------------------------------------------------------------

# VPC ID（执行 02-vpc 后从 AWS Console 获取）
VPC_ID=vpc-xxxxxxxxxx

# VPC CIDR（例如 10.0.0.0/16）
VPC_CIDR=10.0.0.0/16

# 私有子网 ID（与 02-vpc/.env.local 一致）
PRIVATE_SUBNET_1_ID=subnet-aaaaaaaa
PRIVATE_SUBNET_2_ID=subnet-bbbbbbbb


# =============================================================================
# 实例类型白名单配置 (Instance Type Whitelist)
# =============================================================================
# 限制用户在 Studio 中可选择的实例类型，防止启动高成本机器
#
# 预设类型:
#   default        - 基础开发实例 (ml.t3.*, ml.m5.large/xlarge)
#   gpu            - 包含 GPU 实例 (ml.g4dn.*, ml.g5.*)
#   large_memory   - 大内存实例 (ml.r5.*)
#   high_performance - 高性能计算 (ml.c5.*, ml.p3.*)
#   unrestricted   - 不限制 (不创建白名单策略)
# =============================================================================

# -----------------------------------------------------------------------------
# 预设白名单定义 (可自定义)
# -----------------------------------------------------------------------------
# 格式: 逗号分隔的实例类型列表
# 注意: 必须包含 "system" 否则 JupyterLab 无法启动

INSTANCE_WHITELIST_PRESET_default="ml.t3.medium,ml.t3.large,ml.m5.large,ml.m5.xlarge,system"
INSTANCE_WHITELIST_PRESET_gpu="ml.t3.medium,ml.t3.large,ml.m5.xlarge,ml.g4dn.xlarge,ml.g4dn.2xlarge,ml.g5.xlarge,system"
INSTANCE_WHITELIST_PRESET_large_memory="ml.t3.medium,ml.t3.large,ml.m5.xlarge,ml.r5.large,ml.r5.xlarge,ml.r5.2xlarge,system"
INSTANCE_WHITELIST_PRESET_high_performance="ml.t3.medium,ml.m5.xlarge,ml.m5.2xlarge,ml.c5.xlarge,ml.c5.2xlarge,ml.p3.2xlarge,system"

# -----------------------------------------------------------------------------
# 团队级白名单配置 (可选，作为项目默认值)
# -----------------------------------------------------------------------------
# 格式: TEAM_{TEAM_ID}_INSTANCE_WHITELIST=<preset_name>

# TEAM_RC_INSTANCE_WHITELIST=default
# TEAM_ALGO_INSTANCE_WHITELIST=gpu

# -----------------------------------------------------------------------------
# 项目级白名单配置
# -----------------------------------------------------------------------------
# 格式: PROJECT_{TEAM}_{PROJECT}_INSTANCE_WHITELIST=<preset_name>
# 注意: 项目名中的连字符 (-) 转换为下划线 (_)
#
# 示例:
#   fraud-detection -> FRAUD_DETECTION
#   anti-money-laundering -> ANTI_MONEY_LAUNDERING
#   recommendation-engine -> RECOMMENDATION_ENGINE

PROJECT_RC_FRAUD_DETECTION_INSTANCE_WHITELIST=default
PROJECT_RC_ANTI_MONEY_LAUNDERING_INSTANCE_WHITELIST=default
PROJECT_ALGO_RECOMMENDATION_ENGINE_INSTANCE_WHITELIST=gpu

# =============================================================================
# 白名单配置说明
# =============================================================================
#
# 1. 初始化时 (01-iam/setup-all.sh):
#    - 根据上述配置自动创建实例类型白名单策略
#    - 策略附加到项目的 Execution Role
#
# 2. 运维变更 (08-operations/project/set-instance-whitelist.sh):
#    - 临时升级: ./set-instance-whitelist.sh rc fraud preset gpu
#    - 恢复默认: ./set-instance-whitelist.sh rc fraud reset
#    - 自定义:   ./set-instance-whitelist.sh rc fraud custom "ml.t3.medium,ml.p3.2xlarge,system"
#
# 3. 查看状态 (08-operations/query/list-instance-whitelists.sh):
#    - 列出所有项目的白名单配置
#
# =============================================================================
